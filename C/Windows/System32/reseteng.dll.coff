Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\System32\reseteng.dll

File Type: DLL

  Image has the following dependencies:

    msvcrt.dll
    ntdll.dll
    dbghelp.dll
    KERNEL32.dll
    ReAgent.dll
    bcrypt.dll
    FLTLIB.DLL
    USER32.dll
    SHELL32.dll
    ole32.dll
    OLEAUT32.dll
    SETUPAPI.dll
    imagehlp.dll
    RPCRT4.dll
    ADVAPI32.dll
    SHLWAPI.dll
    DismApi.DLL
    VSSAPI.DLL
    tbs.dll
    VirtDisk.dll
    VERSION.dll
    Cabinet.dll
    WDSCORE.dll

  Section contains the following exports for ResetEng.dll

    00000000 characteristics
     7C7F7D2 time date stamp
        0.00 version
           1 ordinal base
          52 number of functions
          52 number of names

    ordinal hint RVA      name

          1    0 00005A60 RjvApplyData
          2    1 0000A040 RjvApplyDataEntryPoint
          3    2 00003950 RjvBareMetalResetAvailable
          4    3 000053D0 RjvBasicReset
          5    4 00004180 RjvBasicResetChecks
          6    5 00007E30 RjvCheckBattery
          7    6 00007FA0 RjvCheckBitLocker
          8    7 000080E0 RjvCheckDiskSpace
          9    8 00008390 RjvCheckOsHealth
         10    9 00007640 RjvCheckWinRE
         11    A 00006020 RjvCleanup
         12    B 00009B90 RjvCommitReset
         13    C 00009D00 RjvCreateSuccessTaskEntryPoint
         14    D 000063D0 RjvDelayedCleanup
         15    E 00009D60 RjvDelayedCleanupEntryPoint
         16    F 00003650 RjvFactoryImageAvailable
         17   10 00005640 RjvFactoryReset
         18   11 00004570 RjvFactoryResetChecks
         19   12 00009CB0 RjvFinalize
         20   13 00007600 RjvGenerateImageBasedBMRConfigData
         21   14 00007620 RjvGenerateReconstructionBMRConfigData
         22   15 0000D080 RjvGetCloudRecInfo
         23   16 00008960 RjvGetVolumeInfo
         24   17 00002360 RjvInitializeEngine
         25   18 0000D2B0 RjvInitializeSystemPartitionInfo
         26   19 0000D010 RjvIsCloudRec
         27   1A 00008E80 RjvLoadState
         28   1B 00009F80 RjvLogFailureEntryPoint
         29   1C 00009D70 RjvLogSuccessEntryPoint
         30   1D 000093E0 RjvOfflineCleanup
         31   1E 000227D0 RjvPDeleteFilesFromVolumeBeforeWimApply
         32   1F 000238E0 RjvPEraseVolume
         33   20 00003D60 RjvPolicyAllowsReset
         34   21 0000A380 RjvPostApplyDataEntryPoint
         35   22 0000A0F0 RjvPreApplyDataEntryPoint
         36   23 00004D40 RjvPrepareForReset
         37   24 000029F0 RjvReInitializeEngine
         38   25 0000D0E0 RjvRePartitionSystemDisk
         39   26 0000D430 RjvRePartitionSystemDiskEx
         40   27 00006260 RjvRollBack
         41   28 00009200 RjvSaveState
         42   29 00003550 RjvSendCancelEvent
         43   2A 0000D020 RjvSetCloudRecInfo
         44   2B 00009960 RjvStageBasicReset
         45   2C 00002150 RjvStartLogging
         46   2D 00002300 RjvStopLogging
         47   2E 0000A520 RjvSysResetErrBasicEntryPoint
         48   2F 0000A4A0 RjvSysResetErrFactoryEntryPoint
         49   30 0000CFB0 RjvTestFunction
         50   31 000052D0 RjvUndoPrepareForReset
         51   32 00003480 RjvUninitializeEngine
         52   33 00004A10 RjvVerifySystemDiskInfo

  Section contains the following imports:

    msvcrt.dll
             1800E38E0 Import Address Table
             180126D38 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         4EA toupper
                         4CD strncmp
                         3A6 _wcsupr
                         2DB _snwscanf_s
                         50D wcsncpy_s
                         36B _vsnwprintf_s
                         51B wcstoul
                         4C5 strcpy_s
                         4A4 qsort
                         38E _wcslwr
                         39E _wcstoi64
                         405 _wtoi
                         33B _ultow_s
                         50B wcsncmp
                         495 memmove_s
                         493 memcpy_s
                         520 wprintf
                         491 memcmp
                         492 memcpy
                         494 memmove
                         496 memset
                         290 _onexit
                          7B __dllonexit
                         341 _unlock
                         1E6 _lock
                          12 ??1type_info@@UEAA@XZ
                          2F ?terminate@@YAXXZ
                         17D _initterm
                          AE _amsg_exit
                          55 _XcptFilter
                          4B _CxxThrowException
                          BF _callnewh
                          31 ?what@exception@@UEBAPEBDXZ
                          11 ??1exception@@UEAA@XZ
                           C ??0exception@@QEAA@AEBV0@@Z
                           B ??0exception@@QEAA@AEBQEBDH@Z
                         514 wcsstr
                          B4 _atoi64
                         421 atol
                         4DE swscanf_s
                         390 _wcslwr_s
                          57 __C_specific_handler
                         29E _purecall
                         4B9 sprintf_s
                         50E wcsnlen
                         385 _wcsdup
                         4DC swprintf_s
                         500 wcscat_s
                         505 wcscpy_s
                         456 fwprintf_s
                         2D7 _snwprintf_s
                         46F iswalpha
                         363 _vsnprintf
                         510 wcsrchr
                         2BD _set_errno
                         518 wcstol
                         105 _errno
                         501 wcschr
                         478 iswspace
                         394 _wcsnicmp
                         360 _vscwprintf
                         439 fflush
                         457 fwrite
                         436 fclose
                         4EC towupper
                         502 wcscmp
                         44B fread
                         3C4 _wfopen_s
                         369 _vsnwprintf
                         486 malloc
                         44C free
                         38A _wcsicmp
                          5B __CxxFrameHandler3

    ntdll.dll
             1800E3B30 Import Address Table
             180126F88 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         2F9 RtlCheckPortableOperatingSystem
                         310 RtlCompareMemory
                         152 NtEnumerateBootEntries
                         1D2 NtQueryDirectoryObject
                         19C NtOpenDirectoryObject
                         27A NtTranslateFilePath
                         1CC NtQueryBootOptions
                         1CB NtQueryBootEntryOrder
                         1FE NtQueryValueKey
                         14A NtDeviceIoControlFile
                         1F6 NtQuerySymbolicLinkObject
                         1A3 NtOpenKey
                         1B4 NtOpenSymbolicLinkObject
                         1C1 NtPrivilegeCheck
                         1B7 NtOpenThreadTokenEx
                         24B NtSetInformationThread
                         1AE NtOpenProcessTokenEx
                          CD NtAdjustPrivilegesToken
                         7CB ZwOpenDirectoryObject
                         7E3 ZwOpenSymbolicLinkObject
                         801 ZwQueryDirectoryObject
                         77A ZwDeviceIoControlFile
                         825 ZwQuerySymbolicLinkObject
                         706 ZwAllocateUuids
                         7DB ZwOpenProcess
                         809 ZwQueryInformationFile
                         773 ZwDeleteFile
                         80C ZwQueryInformationProcess
                          78 LdrGetDllHandle
                         82F ZwQueryVolumeInformationFile
                          80 LdrGetProcedureAddress
                         7D2 ZwOpenKey
                         893 ZwSetValueKey
                         34A RtlCreateSecurityDescriptor
                         8AC ZwUnloadKey
                         887 ZwSetSecurityObject
                         337 RtlCreateAcl
                         82D ZwQueryValueKey
                         784 ZwEnumerateKey
                         774 ZwDeleteKey
                         3FA RtlFreeSid
                         85C ZwSaveKey
                         777 ZwDeleteValueKey
                         4D3 RtlLengthSid
                         2D0 RtlAllocateAndInitializeSid
                         2B3 RtlAddAccessAllowedAceEx
                         7B3 ZwLoadKey
                         74B ZwCreateKey
                         746 ZwCreateFile
                         596 RtlSetDaclSecurityDescriptor
                         5A5 RtlSetOwnerSecurityDescriptor
                         4D2 RtlLengthSecurityDescriptor
                         7F8 ZwQueryAttributesFile
                         2DE RtlAppendUnicodeToString
                         400 RtlGUIDFromString
                         828 ZwQuerySystemInformation
                         7D7 ZwOpenMutant
                         841 ZwReleaseMutant
                         816 ZwQueryKey
                         8BB ZwWaitForSingleObject
                         72D ZwClose
                         7CF ZwOpenFile
                         5CE RtlStringFromGUID
                         295 NtYieldExecution
                         554 RtlReAllocateHeap
                          23 DbgPrintEx
                         54F RtlRaiseStatus
                         479 RtlInitializeCriticalSection
                         378 RtlDeleteResource
                         565 RtlReleaseResource
                         2AC RtlAcquireResourceShared
                         2AB RtlAcquireResourceExclusive
                         483 RtlInitializeResource
                         460 RtlImpersonateSelf
                         23C NtSetEaFile
                         1A0 NtOpenFile
                          FD NtClose
                         116 NtCreateFile
                         244 NtSetInformationFile
                         1DD NtQueryInformationProcess
                         200 NtQueryVolumeInformationFile
                         1DA NtQueryInformationFile
                         258 NtSetSecurityObject
                         3D1 RtlFindAceByType
                         591 RtlSetControlSecurityDescriptor
                         426 RtlGetLastNtStatus
                         463 RtlInitAnsiString
                         3FD RtlFreeUnicodeString
                         2D3 RtlAllocateHeap
                         1F9 NtQuerySystemInformation
                         2CE RtlAdjustPrivilege
                         1D0 NtQueryDirectoryFile
                         2DD RtlAppendUnicodeStringToString
                         6DC WinSqmEndSession
                         6EA WinSqmSetString
                         6E6 WinSqmSetDWORD64
                         6E5 WinSqmSetDWORD
                         6EB WinSqmStartSession
                         397 RtlDosPathNameToNtPathName_U
                         452 RtlGetVersion
                         470 RtlInitUnicodeString
                         3F6 RtlFreeHeap
                         500 RtlNtStatusToDosErrorNoTeb
                         4FF RtlNtStatusToDosError
                         2F3 RtlCaptureContext
                         4EA RtlLookupFunctionEntry
                         629 RtlVirtualUnwind

    dbghelp.dll
             1800E38B8 Import Address Table
             180126D10 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          16 ImageNtHeader

    KERNEL32.dll
             1800E31B8 Import Address Table
             180126610 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         526 SetEvent
                         5EA WaitForSingleObject
                         327 GetVersionExW
                         27D GetModuleFileNameW
                         64A lstrcmpiW
                         2ED GetSystemInfo
                         124 DeviceIoControl
                         32E GetVolumePathNameW
                         32C GetVolumeNameForVolumeMountPointW
                         255 GetFileSize
                         25E GetFirmwareEnvironmentVariableW
                         330 GetVolumePathNamesForVolumeNameW
                         233 GetDiskFreeSpaceW
                         351 HeapAlloc
                         2BE GetProcessHeap
                         189 FindFirstFileW
                         195 FindNextFileW
                         17E FindClose
                         355 HeapFree
                          BD CreateDirectoryW
                         52D SetFileAttributesW
                          E0 CreatePipe
                          E8 CreateProcessW
                          CB CreateFileMappingW
                         3E5 MapViewOfFile
                         5C3 UnmapViewOfFile
                         21A GetCurrentDirectoryW
                           8 AddDllDirectory
                          F5 CreateThread
                         2B8 GetProcAddress
                         1B4 FreeLibrary
                         5E8 WaitForMultipleObjects
                         586 SetVolumeMountPointW
                         3D1 LocalAlloc
                         3D6 LocalFree
                         536 SetFileTime
                          AA CopyFile2
                         257 GetFileTime
                         53B SetFirmwareEnvironmentVariableW
                         220 GetCurrentProcess
                         4BF RemoveDirectoryW
                         5C0 UnhandledExceptionFilter
                         57F SetUnhandledExceptionFilter
                         452 QueryPerformanceCounter
                         221 GetCurrentProcessId
                         225 GetCurrentThreadId
                         311 GetTickCount
                         530 SetFileInformationByHandle
                         263 GetFullPathNameW
                         36B InitializeCriticalSectionAndSpinCount
                         3E1 LockFileEx
                         5C2 UnlockFileEx
                         26B GetLocalTime
                         412 OpenProcess
                          AD CopyFileExW
                         132 DuplicateHandle
                         2B3 GetPrivateProfileSectionW
                          C2 CreateEventW
                         246 GetExitCodeProcess
                         3CA LoadLibraryExW
                         59E TerminateProcess
                          EF CreateSemaphoreW
                         329 GetVolumeInformationByHandleW
                         346 GlobalMemoryStatusEx
                         406 OpenEventW
                         5B0 TlsAlloc
                         5B1 TlsFree
                         5B2 TlsGetValue
                          9E CompareStringW
                         25A GetFinalPathNameByHandleW
                         2EA GetSystemDirectoryW
                         5B3 TlsSetValue
                         5E9 WaitForMultipleObjectsEx
                         4CC ResetEvent
                         12D DosDateTimeToFileTime
                         3D3 LocalFileTimeToFileTime
                         252 GetFileInformationByHandleEx
                         277 GetLongPathNameW
                         35A HeapSize
                         468 RaiseException
                         184 FindFirstFileExW
                         326 GetVersionExA
                         354 HeapDestroy
                         5F2 WakeAllConditionVariable
                         591 SleepConditionVariableSRW
                         312 GetTickCount64
                         24F GetFileAttributesW
                         256 GetFileSizeEx
                         479 ReadFile
                          CE CreateFileW
                         532 SetFilePointer
                         625 WriteFile
                         119 DeleteFileW
                         519 SetCurrentDirectoryW
                         2F7 GetSystemWindowsDirectoryW
                          B0 CopyFileW
                         26A GetLastError
                          89 CloseHandle
                         358 HeapReAlloc
                         56A SetThreadIdealProcessor
                         251 GetFileInformationByHandle
                         520 SetEndOfFile
                         533 SetFilePointerEx
                         267 GetHandleInformation
                         385 IsDebuggerPresent
                         10A DebugBreak
                           1 AcquireSRWLockShared
                          DC CreateMutexExW
                          F9 CreateThreadpoolTimer
                         4B9 ReleaseSRWLockShared
                         578 SetThreadpoolTimer
                         416 OpenSemaphoreW
                         5EB WaitForSingleObjectEx
                           0 AcquireSRWLockExclusive
                          93 CloseThreadpoolTimer
                         41E OutputDebugStringW
                         4B8 ReleaseSRWLockExclusive
                         1B0 FormatMessageW
                         4B6 ReleaseMutex
                         5ED WaitForThreadpoolTimerCallbacks
                         36C InitializeCriticalSectionEx
                         280 GetModuleHandleExW
                         4BA ReleaseSemaphore
                          EE CreateSemaphoreExW
                         27C GetModuleFileNameA
                         114 DeleteCriticalSection
                         2A2 GetOverlappedResult
                         224 GetCurrentThread
                         36A InitializeCriticalSection
                         3C4 LeaveCriticalSection
                         138 EnterCriticalSection
                         3EF MoveFileExW
                         281 GetModuleHandleW
                         32A GetVolumeInformationW
                         1A8 FlushFileBuffers
                          D2 CreateHardLinkW
                         30A GetThreadPreferredUILanguages
                         611 WideCharToMultiByte
                         300 GetTempPathW
                         3CB LoadLibraryW
                         332 GetWindowsDirectoryW
                         3F6 MultiByteToWideChar
                         541 SetLastError
                         243 GetEnvironmentVariableW
                         1A1 FindVolumeClose
                         19A FindNextVolumeW
                         239 GetDriveTypeW
                         18F FindFirstVolumeW
                         525 SetErrorMode
                         58F Sleep
                         2F3 GetSystemTimeAsFileTime
                         232 GetDiskFreeSpaceExW
                         2EE GetSystemPowerStatus
                         16B ExpandEnvironmentStringsW
                         42B PowerSetRequest
                         42A PowerCreateRequest
                         59A SystemTimeToFileTime

    ReAgent.dll
             1800E3730 Import Address Table
             180126B88 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          25 WinReRestoreLogFiles
                          1B WinReIsWimBootEnabled
                           F WinReGetConfig
                           E WinReDeleteLogFiles
                          2B WinReSetRecoveryAction
                          19 WinReInstallOnTargetOS

    bcrypt.dll
             1800E3878 Import Address Table
             180126CD0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          27 BCryptOpenAlgorithmProvider
                          21 BCryptGetProperty
                           6 BCryptCreateHash
                          23 BCryptHashData
                          1B BCryptFinishHash
                           D BCryptDestroyHash
                           2 BCryptCloseAlgorithmProvider

    FLTLIB.DLL
             1800E31A0 Import Address Table
             1801265F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          12 FilterLoad
                           0 FilterAttach

    USER32.dll
             1800E37C8 Import Address Table
             180126C20 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         267 LoadStringW
                         3B7 UnregisterClassA
                          3F CharUpperW

    SHELL32.dll
             1800E37A8 Import Address Table
             180126C00 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         1AE ShellExecuteExW

    ole32.dll
             1800E3E90 Import Address Table
             1801272E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          62 CoInitializeSecurity
                          61 CoInitializeEx
                          2A CoCreateGuid
                          90 CoUninitialize
                          2B CoCreateInstance
                          8C CoTaskMemFree
                          87 CoSetProxyBlanket

    OLEAUT32.dll
             1800E36A8 Import Address Table
             180126B00 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    23
                             Ordinal     8
                             Ordinal     9
                             Ordinal   149
                             Ordinal     2
                             Ordinal    10
                             Ordinal     7
                             Ordinal    24
                             Ordinal     6
                             Ordinal     4

    SETUPAPI.dll
             1800E3768 Import Address Table
             180126BC0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         16C SetupDiGetDeviceInterfaceDetailW
                         13D SetupDiDestroyDeviceInfoList
                         16E SetupDiGetDeviceInterfacePropertyW
                         141 SetupDiEnumDeviceInterfaces
                         193 SetupDiOpenDeviceInfoW
                         170 SetupDiGetDevicePropertyW
                         154 SetupDiGetClassDevsW

    imagehlp.dll
             1800E38C8 Import Address Table
             180126D20 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1F ImageUnload
                          1A ImageLoad

    RPCRT4.dll
             1800E3700 Import Address Table
             180126B58 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         226 UuidToStringW
                         21D UuidCreate
                         21C UuidCompare
                         214 RpcStringFreeW
                          44 I_RpcMapWin32Status

    ADVAPI32.dll
             1800E2F90 Import Address Table
             1801263E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1F AdjustTokenPrivileges
                         121 EventRegister
                         122 EventSetInformation
                         129 EventWriteTransfer
                         288 RegLoadKeyW
                         284 RegGetValueW
                         2A9 RegSetKeyValueW
                         28F RegOpenKeyExW
                         25E RegCloseKey
                         2C4 RevertToSelf
                          63 CloseEncryptedFileRaw
                         35B WriteEncryptedFileRaw
                         215 OpenEncryptedFileRawW
                         281 RegFlushKey
                         276 RegDeleteValueW
                         138 GetAclInformation
                         15F GetSecurityDescriptorLength
                         15C GetSecurityDescriptorControl
                         124 EventWrite
                         2F0 SetSecurityInfo
                         163 GetSecurityInfo
                         264 RegCopyTreeW
                         274 RegDeleteTreeW
                         2E6 SetNamedSecurityInfoW
                         162 GetSecurityDescriptorSacl
                         15D GetSecurityDescriptorDacl
                         15E GetSecurityDescriptorGroup
                         160 GetSecurityDescriptorOwner
                          81 ConvertStringSecurityDescriptorToSecurityDescriptorW
                         32B TraceMessage
                         195 InitiateSystemShutdownExW
                         1AF LookupPrivilegeValueW
                         218 OpenProcessToken
                         2DF SetFileSecurityW
                         145 GetFileSecurityW
                          D2 CryptGenRandom
                          C2 CryptAcquireContextW
                         267 RegCreateKeyExW
                         27D RegEnumKeyExW
                         296 RegQueryInfoKeyW
                         29C RegQueryValueExW
                         120 EventProviderEnabled
                         302 StopTraceW
                          67 CloseTrace
                         108 EnableTraceEx
                         300 StartTraceW
                         2AC RegSetValueExW
                         2AF RegUnLoadKeyW
                         123 EventUnregister

    SHLWAPI.dll
             1800E37B8 Import Address Table
             180126C10 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         123 StrCmpIW

    DismApi.DLL
             1800E3140 Import Address Table
             180126598 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          23 DismUnmountImage
                          1A DismMountImage
                          57 _DismSetProductKey
                          25 _DismAddDriverEx
                           6 DismCloseSession
                           8 DismDelete
                          33 _DismGetCurrentEdition
                          3E _DismGetOsInfo
                          1B DismOpenSession
                          19 DismInitialize
                          22 DismShutdown

    VSSAPI.DLL
             1800E3808 Import Address Table
             180126C60 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          53 VssFreeSnapshotPropertiesInternal
                          43 CreateVssBackupComponentsInternal

    tbs.dll
             1800E3ED0 Import Address Table
             180127328 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 Tbsi_Context_Create
                           C Tbsi_Physical_Presence_Command
                           7 Tbsi_GetDeviceInfo
                          10 Tbsip_Context_Close

    VirtDisk.dll
             1800E3820 Import Address Table
             180126C78 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           E GetStorageDependencyInformation

    VERSION.dll
             1800E37E8 Import Address Table
             180126C40 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 GetFileVersionInfoExW
                           6 GetFileVersionInfoSizeExW
                          10 VerQueryValueW

    Cabinet.dll
             1800E3120 Import Address Table
             180126578 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    23
                             Ordinal    22
                             Ordinal    20

    WDSCORE.dll
             1800E3830 Import Address Table
             180126C88 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 ConstructPartialMsgVW
                          28 WdsGenericSetupLogInit
                          52 WdsSetupLogDestroy
                           2 ConstructPartialMsgVA
                          31 WdsGetSetupLog
                          54 WdsSetupLogMessageA
                           4 CurrentIP
                          55 WdsSetupLogMessageW

  Summary

        6000 .data
        6000 .pdata
       49000 .rdata
        1000 .reloc
        1000 .rsrc
       E0000 .text
