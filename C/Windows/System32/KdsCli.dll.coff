Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\System32\KdsCli.dll

File Type: DLL

  Image has the following dependencies:

    WLDAP32.dll
    api-ms-win-core-libraryloader-l1-2-0.dll
    api-ms-win-security-sddl-l1-1-0.dll
    api-ms-win-core-errorhandling-l1-1-0.dll
    bcrypt.dll
    api-ms-win-core-heap-l2-1-0.dll
    api-ms-win-core-profile-l1-1-0.dll
    api-ms-win-core-processthreads-l1-1-0.dll
    api-ms-win-core-sysinfo-l1-1-0.dll
    api-ms-win-core-rtlsupport-l1-1-0.dll
    api-ms-win-core-file-l1-1-0.dll
    CRYPT32.dll
    api-ms-win-core-handle-l1-1-0.dll
    api-ms-win-core-synch-l1-1-0.dll
    api-ms-win-security-base-l1-1-0.dll
    api-ms-win-core-heap-l1-1-0.dll
    api-ms-win-core-timezone-l1-1-0.dll
    api-ms-win-core-string-l1-1-0.dll
    profapi.dll
    api-ms-win-security-lsalookup-l1-1-2.dll
    api-ms-win-security-lsapolicy-l1-1-0.dll
    api-ms-win-security-base-private-l1-1-0.dll
    api-ms-win-core-kernel32-legacy-l1-1-0.dll
    NTASN1.dll
    ntdll.dll
    api-ms-win-core-delayload-l1-1-1.dll
    api-ms-win-core-delayload-l1-1-0.dll

  Image has the following delay load dependencies:

    RPCRT4.dll
    logoncli.dll
    netutils.dll

  Section contains the following exports for KdsCli.dll

    00000000 characteristics
    5DFDF7D9 time date stamp
        0.00 version
           1 ordinal base
          48 number of functions
          48 number of names

    ordinal hint RVA      name

          1    0 00003080 CreateRootKey
          2    1 00007DB0 DeleteAllCachedKeys
          3    2 00007440 FindAndReadSIDKeyInCache
          4    3 00007880 FindKeyForOfflineUsage
          5    4 00002E00 FreeRootKey
          6    5 00002D80 FreeRootKeyConfig
          7    6 00004B50 FreeRootKeyMetaDataList
          8    7 00004F20 FreeServerConfig
          9    8 000082D0 GenerateDerivedKey
         10    9 00008E70 GenerateEphemeralKeyPair
         11    A 000081F0 GenerateKDFContext
         12    B 000091B0 GenerateSIDPublicKeyBlob
         13    C 00008840 GenerateSecretAgreementPrivateKey
         14    D 00004980 GetAllRootKeys
         15    E 00004C90 GetAllRootKeysMetaData
         16    F 0000A4D0 GetAndLockCachedRPCBinding
         17   10 0000B260 GetCachedMachineDomainInfo
         18   11 0000AD30 GetCurrentIntervalID
         19   12 0000ACE0 GetCurrentL0ID
         20   13 0000AC80 GetCurrentTimeInULL
         21   14 000016D0 GetDCInfo
         22   15 00005950 GetDefaultServerConfig
         23   16 0000B450 GetFullDCName
         24   17 0000ADA0 GetIntervalStartTime
         25   18 000021E0 GetKDSSrvConfigPath
         26   19 0000B550 GetKdsKeyCycleDuration
         27   1A 0000B660 GetKey
         28   1B 00001230 GetLdapBinding
         29   1C 000022D0 GetMRKPath
         30   1D 000048E0 GetRootKey
         31   1E 000062F0 GetSIDKeyCacheFolder
         32   1F 00006670 GetSIDKeyFileName
         33   20 00005A00 GetServerConfig
         34   21 0000AB40 GetUserSidStr
         35   22 00009980 KdsCreateClientBinding
         36   23 0000BB30 KdsGetEpochLength
         37   24 0000C330 KdsGetGmsaPasswordBasedOnKeyId
         38   25 0000C320 KdsGetGmsaPasswordBasedOnTimestamp
         39   26 0000BAB0 KdsGetKeyStartTime
         40   27 0000C810 SIDKeyProtect
         41   28 0000A620 SIDKeyProvAlloc
         42   29 0000A660 SIDKeyProvFree
         43   2A 0000CDA0 SIDKeyUnprotect
         44   2B 00005E30 SetServerConfig
         45   2C 00008630 TestServerConfig
         46   2D 0000A5D0 UnlockRpcCache
         47   2E 00005AF0 ValidateSrvConfig
         48   2F 000069D0 WriteSIDKeyInCache

  Section contains the following imports:

    WLDAP32.dll
             180010498 Import Address Table
             180013460 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    41
                             Ordinal    69
                             Ordinal   145
                             Ordinal    97
                             Ordinal   140
                             Ordinal    14
                             Ordinal   203
                             Ordinal    16
                             Ordinal   127
                             Ordinal    27
                             Ordinal    36
                             Ordinal    79
                             Ordinal    13
                             Ordinal   147
                             Ordinal   167
                             Ordinal   142
                             Ordinal    26
                             Ordinal   157
                             Ordinal   224
                             Ordinal    73
                             Ordinal   301

    api-ms-win-core-libraryloader-l1-2-0.dll
             180010630 Import Address Table
             1800135F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 DisableThreadLibraryCalls

    api-ms-win-security-sddl-l1-1-0.dll
             1800107D0 Import Address Table
             180013798 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 ConvertStringSidToSidW
                           1 ConvertSidToStringSidW
                           2 ConvertStringSecurityDescriptorToSecurityDescriptorW

    api-ms-win-core-errorhandling-l1-1-0.dll
             180010568 Import Address Table
             180013530 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F SetUnhandledExceptionFilter
                          11 UnhandledExceptionFilter
                           5 GetLastError

    bcrypt.dll
             1800107F0 Import Address Table
             1800137B8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          21 BCryptGetProperty
                           2 BCryptCloseAlgorithmProvider
                          27 BCryptOpenAlgorithmProvider
                          24 BCryptImportKey
                          32 BCryptSecretAgreement
                          1B BCryptFinishHash
                          35 BCryptSetProperty
                          25 BCryptImportKeyPair
                           F BCryptDestroySecret
                           A BCryptDeriveKey
                          19 BCryptExportKey
                          1E BCryptGenerateKeyPair
                           D BCryptDestroyHash
                          23 BCryptHashData
                           6 BCryptCreateHash
                           E BCryptDestroyKey
                          26 BCryptKeyDerivation
                          1F BCryptGenerateSymmetricKey
                          1A BCryptFinalizeKeyPair
                          1D BCryptGenRandom

    api-ms-win-core-heap-l2-1-0.dll
             180010610 Import Address Table
             1800135D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 LocalFree

    api-ms-win-core-profile-l1-1-0.dll
             180010680 Import Address Table
             180013648 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 QueryPerformanceCounter

    api-ms-win-core-processthreads-l1-1-0.dll
             180010640 Import Address Table
             180013608 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          10 GetCurrentThread
                          31 OpenProcessToken
                          33 OpenThreadToken
                           C GetCurrentProcess
                          4E TerminateProcess
                          11 GetCurrentThreadId
                           D GetCurrentProcessId

    api-ms-win-core-sysinfo-l1-1-0.dll
             1800106F0 Import Address Table
             1800136B8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          13 GetSystemTime
                          1A GetTickCount
                          16 GetSystemTimeAsFileTime

    api-ms-win-core-rtlsupport-l1-1-0.dll
             180010690 Import Address Table
             180013658 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 RtlCaptureContext
                           A RtlLookupFunctionEntry
                          10 RtlVirtualUnwind

    api-ms-win-core-file-l1-1-0.dll
             180010588 Import Address Table
             180013550 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          49 ReadFile
                          2E GetFileSize
                           3 CreateDirectoryW
                          1A FindNextFileW
                          5B WriteFile
                          4D RemoveDirectoryW
                           C FindClose
                           6 CreateFileW
                           9 DeleteFileW
                          12 FindFirstFileExW

    CRYPT32.dll
             180010458 Import Address Table
             180013420 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          C3 CryptProtectData
                          E1 CryptUnprotectData
                          7D CryptBinaryToStringW

    api-ms-win-core-handle-l1-1-0.dll
             1800105E0 Import Address Table
             1800135A8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseHandle

    api-ms-win-core-synch-l1-1-0.dll
             1800106C0 Import Address Table
             180013688 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 AcquireSRWLockExclusive
                          24 ReleaseSRWLockExclusive
                          25 ReleaseSRWLockShared
                           1 AcquireSRWLockShared
                          1B InitializeSRWLock

    api-ms-win-security-base-l1-1-0.dll
             180010720 Import Address Table
             1800136E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          63 SetSecurityDescriptorGroup
                          64 SetSecurityDescriptorOwner
                          62 SetSecurityDescriptorDacl
                          48 InitializeSecurityDescriptor
                          4C IsValidSecurityDescriptor
                          3A GetSecurityDescriptorLength
                          47 InitializeAcl
                          1E CopySid
                          4D IsValidSid
                          35 GetLengthSid
                          42 GetTokenInformation
                           7 AddAccessAllowedAce

    api-ms-win-core-heap-l1-1-0.dll
             1800105F0 Import Address Table
             1800135B8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           6 HeapFree
                           0 GetProcessHeap
                           2 HeapAlloc

    api-ms-win-core-timezone-l1-1-0.dll
             180010710 Import Address Table
             1800136D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           A SystemTimeToFileTime

    api-ms-win-core-string-l1-1-0.dll
             1800106B0 Import Address Table
             180013678 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 CompareStringW

    profapi.dll
             180010988 Import Address Table
             180013950 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal   104

    api-ms-win-security-lsalookup-l1-1-2.dll
             180010798 Import Address Table
             180013760 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F LsaLookupUserAccountType

    api-ms-win-security-lsapolicy-l1-1-0.dll
             1800107A8 Import Address Table
             180013770 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          10 LsaQueryInformationPolicy
                           1 LsaClose
                           6 LsaFreeMemory
                           E LsaOpenPolicy

    api-ms-win-security-base-private-l1-1-0.dll
             180010788 Import Address Table
             180013750 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 IsValidRelativeSecurityDescriptor

    api-ms-win-core-kernel32-legacy-l1-1-0.dll
             180010620 Import Address Table
             1800135E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 CreateFileTransactedW

    NTASN1.dll
             180010478 Import Address Table
             180013440 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal     4
                             Ordinal     2
                             Ordinal     5

    ntdll.dll
             180010898 Import Address Table
             180013860 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         8F8 _ultow_s
                         96A wcscpy_s
                         90D _wtoi64
                          45 EtwEventWriteTransfer
                         8F4 _ui64tow_s
                         136 NtCreateTransaction
                         22A NtRollbackTransaction
                         966 wcscat_s
                         967 wcschr
                         102 NtCommitTransaction
                         24A NtSetInformationThread
                         4FD RtlNtStatusToDosError
                         46E RtlInitUnicodeString
                         5F6 RtlUnicodeStringToInteger
                         8C2 __C_specific_handler
                         4EA RtlMakeSelfRelativeSD
                         45A RtlImageNtHeader
                          3B EtwEventRegister
                          3D EtwEventUnregister
                          46 EtwGetTraceEnableFlags
                          48 EtwGetTraceLoggerHandle
                          47 EtwGetTraceEnableLevel
                          4F EtwRegisterTraceGuidsW
                         959 swprintf_s
                          54 EtwTraceMessage
                         935 memcpy
                         939 memset
                          56 EtwUnregisterTraceGuids
                         968 wcscmp

    api-ms-win-core-delayload-l1-1-1.dll
             180010558 Import Address Table
             180013520 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 ResolveDelayLoadedAPI

    api-ms-win-core-delayload-l1-1-0.dll
             180010548 Import Address Table
             180013510 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 DelayLoadFailureHook

  Section contains the following delay load imports:

    RPCRT4.dll
              00000001 Characteristics
      00000001800155F0 Address of HMODULE
      0000000180017000 Import Address Table
      0000000180012A48 Import Name Table
      0000000180012BC8 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    000000018000F75B   222 UuidFromStringW
                                    000000018000F97A    A4 NdrClientCall3
                                    000000018000F7E6   214 RpcStringFreeW
                                    000000018000F7F8   226 UuidToStringW
                                    000000018000F80A   176 RpcBindingFromStringBindingW
                                    000000018000F81C   210 RpcStringBindingComposeW
                                    000000018000F8DD   174 RpcBindingFree
                                    000000018000F98C    2E I_RpcExceptionFilter
                                    000000018000F8B9   185 RpcBindingSetAuthInfoExW
                                    000000018000F8CB   196 RpcEpResolveBinding

    logoncli.dll
              00000001 Characteristics
      00000001800155F8 Address of HMODULE
      0000000180017058 Import Address Table
      0000000180012AA0 Import Name Table
      0000000180012BF8 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    000000018000F82E    12 DsGetDcNameW

    netutils.dll
              00000001 Characteristics
      0000000180015600 Address of HMODULE
      0000000180017068 Import Address Table
      0000000180012AB0 Import Name Table
      0000000180012C20 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    000000018000F8EF     1 NetApiBufferFree

  Summary

        1000 .data
        1000 .didat
        1000 .pdata
        5000 .rdata
        1000 .reloc
        1000 .rsrc
        F000 .text
