Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\WinSxS\amd64_microsoft-windows-systemreset_31bf3856ad364e35_10.0.19041.1_none_a1018c381b5c937f\reseteng.dll

File Type: DLL

  Image has the following dependencies:

    msvcrt.dll
    ntdll.dll
    dbghelp.dll
    KERNEL32.dll
    ReAgent.dll
    bcrypt.dll
    FLTLIB.DLL
    USER32.dll
    SHELL32.dll
    ole32.dll
    OLEAUT32.dll
    SETUPAPI.dll
    imagehlp.dll
    RPCRT4.dll
    ADVAPI32.dll
    SHLWAPI.dll
    DismApi.DLL
    VSSAPI.DLL
    tbs.dll
    VirtDisk.dll
    VERSION.dll
    Cabinet.dll
    WDSCORE.dll

  Section contains the following exports for ResetEng.dll

    00000000 characteristics
    89988583 time date stamp
        0.00 version
           1 ordinal base
          52 number of functions
          52 number of names

    ordinal hint RVA      name

          1    0 00005A60 RjvApplyData
          2    1 0000A040 RjvApplyDataEntryPoint
          3    2 00003950 RjvBareMetalResetAvailable
          4    3 000053D0 RjvBasicReset
          5    4 00004180 RjvBasicResetChecks
          6    5 00007E30 RjvCheckBattery
          7    6 00007FA0 RjvCheckBitLocker
          8    7 000080E0 RjvCheckDiskSpace
          9    8 00008390 RjvCheckOsHealth
         10    9 00007640 RjvCheckWinRE
         11    A 00006020 RjvCleanup
         12    B 00009B90 RjvCommitReset
         13    C 00009D00 RjvCreateSuccessTaskEntryPoint
         14    D 000063D0 RjvDelayedCleanup
         15    E 00009D60 RjvDelayedCleanupEntryPoint
         16    F 00003650 RjvFactoryImageAvailable
         17   10 00005640 RjvFactoryReset
         18   11 00004570 RjvFactoryResetChecks
         19   12 00009CB0 RjvFinalize
         20   13 00007600 RjvGenerateImageBasedBMRConfigData
         21   14 00007620 RjvGenerateReconstructionBMRConfigData
         22   15 0000D080 RjvGetCloudRecInfo
         23   16 00008960 RjvGetVolumeInfo
         24   17 00002360 RjvInitializeEngine
         25   18 0000D2B0 RjvInitializeSystemPartitionInfo
         26   19 0000D010 RjvIsCloudRec
         27   1A 00008E80 RjvLoadState
         28   1B 00009F80 RjvLogFailureEntryPoint
         29   1C 00009D70 RjvLogSuccessEntryPoint
         30   1D 000093E0 RjvOfflineCleanup
         31   1E 000227D0 RjvPDeleteFilesFromVolumeBeforeWimApply
         32   1F 000238E0 RjvPEraseVolume
         33   20 00003D60 RjvPolicyAllowsReset
         34   21 0000A380 RjvPostApplyDataEntryPoint
         35   22 0000A0F0 RjvPreApplyDataEntryPoint
         36   23 00004D40 RjvPrepareForReset
         37   24 000029F0 RjvReInitializeEngine
         38   25 0000D0E0 RjvRePartitionSystemDisk
         39   26 0000D430 RjvRePartitionSystemDiskEx
         40   27 00006260 RjvRollBack
         41   28 00009200 RjvSaveState
         42   29 00003550 RjvSendCancelEvent
         43   2A 0000D020 RjvSetCloudRecInfo
         44   2B 00009960 RjvStageBasicReset
         45   2C 00002150 RjvStartLogging
         46   2D 00002300 RjvStopLogging
         47   2E 0000A520 RjvSysResetErrBasicEntryPoint
         48   2F 0000A4A0 RjvSysResetErrFactoryEntryPoint
         49   30 0000CFB0 RjvTestFunction
         50   31 000052D0 RjvUndoPrepareForReset
         51   32 00003480 RjvUninitializeEngine
         52   33 00004A10 RjvVerifySystemDiskInfo

  Section contains the following imports:

    msvcrt.dll
             1800E28D8 Import Address Table
             180125940 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         4EA toupper
                         4CD strncmp
                         3A6 _wcsupr
                         2DB _snwscanf_s
                         50D wcsncpy_s
                         36B _vsnwprintf_s
                         51B wcstoul
                         4C5 strcpy_s
                         4A4 qsort
                         38E _wcslwr
                         39E _wcstoi64
                         405 _wtoi
                         33B _ultow_s
                         50B wcsncmp
                         495 memmove_s
                         493 memcpy_s
                         520 wprintf
                         491 memcmp
                         492 memcpy
                         494 memmove
                         496 memset
                         290 _onexit
                          7B __dllonexit
                         341 _unlock
                         1E6 _lock
                          12 ??1type_info@@UEAA@XZ
                          2F ?terminate@@YAXXZ
                         17D _initterm
                          AE _amsg_exit
                          55 _XcptFilter
                          4B _CxxThrowException
                          BF _callnewh
                          31 ?what@exception@@UEBAPEBDXZ
                          11 ??1exception@@UEAA@XZ
                           C ??0exception@@QEAA@AEBV0@@Z
                           B ??0exception@@QEAA@AEBQEBDH@Z
                         514 wcsstr
                          B4 _atoi64
                         421 atol
                         4DE swscanf_s
                         390 _wcslwr_s
                          57 __C_specific_handler
                         29E _purecall
                         4B9 sprintf_s
                         50E wcsnlen
                         385 _wcsdup
                         4DC swprintf_s
                         500 wcscat_s
                         505 wcscpy_s
                         456 fwprintf_s
                         2D7 _snwprintf_s
                         46F iswalpha
                         363 _vsnprintf
                         510 wcsrchr
                         2BD _set_errno
                         518 wcstol
                         105 _errno
                         501 wcschr
                         478 iswspace
                         394 _wcsnicmp
                         360 _vscwprintf
                         439 fflush
                         457 fwrite
                         436 fclose
                         44B fread
                         4EC towupper
                         502 wcscmp
                         3C4 _wfopen_s
                         369 _vsnwprintf
                         486 malloc
                         44C free
                         38A _wcsicmp
                          5B __CxxFrameHandler3

    ntdll.dll
             1800E2B28 Import Address Table
             180125B90 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         2F8 RtlCheckPortableOperatingSystem
                         30F RtlCompareMemory
                         152 NtEnumerateBootEntries
                         1D1 NtQueryDirectoryObject
                         19B NtOpenDirectoryObject
                         279 NtTranslateFilePath
                         1CB NtQueryBootOptions
                         1CA NtQueryBootEntryOrder
                         1FD NtQueryValueKey
                         14A NtDeviceIoControlFile
                         1F5 NtQuerySymbolicLinkObject
                         1A2 NtOpenKey
                         1B3 NtOpenSymbolicLinkObject
                         1C0 NtPrivilegeCheck
                         1B6 NtOpenThreadTokenEx
                         24A NtSetInformationThread
                         1AD NtOpenProcessTokenEx
                          CD NtAdjustPrivilegesToken
                         7C8 ZwOpenDirectoryObject
                         7E0 ZwOpenSymbolicLinkObject
                         7FE ZwQueryDirectoryObject
                         778 ZwDeviceIoControlFile
                         822 ZwQuerySymbolicLinkObject
                         704 ZwAllocateUuids
                         7D8 ZwOpenProcess
                         806 ZwQueryInformationFile
                         771 ZwDeleteFile
                         809 ZwQueryInformationProcess
                          78 LdrGetDllHandle
                         82C ZwQueryVolumeInformationFile
                          80 LdrGetProcedureAddress
                         7CF ZwOpenKey
                         890 ZwSetValueKey
                         349 RtlCreateSecurityDescriptor
                         8A9 ZwUnloadKey
                         884 ZwSetSecurityObject
                         336 RtlCreateAcl
                         82A ZwQueryValueKey
                         782 ZwEnumerateKey
                         772 ZwDeleteKey
                         3F9 RtlFreeSid
                         859 ZwSaveKey
                         775 ZwDeleteValueKey
                         4D1 RtlLengthSid
                         2CF RtlAllocateAndInitializeSid
                         2B2 RtlAddAccessAllowedAceEx
                         7B1 ZwLoadKey
                         749 ZwCreateKey
                         744 ZwCreateFile
                         594 RtlSetDaclSecurityDescriptor
                         5A3 RtlSetOwnerSecurityDescriptor
                         4D0 RtlLengthSecurityDescriptor
                         7F5 ZwQueryAttributesFile
                         2DD RtlAppendUnicodeToString
                         3FF RtlGUIDFromString
                         825 ZwQuerySystemInformation
                         7D4 ZwOpenMutant
                         83E ZwReleaseMutant
                         813 ZwQueryKey
                         8B8 ZwWaitForSingleObject
                         72B ZwClose
                         7CC ZwOpenFile
                         5CC RtlStringFromGUID
                         294 NtYieldExecution
                         552 RtlReAllocateHeap
                          23 DbgPrintEx
                         54D RtlRaiseStatus
                         477 RtlInitializeCriticalSection
                         377 RtlDeleteResource
                         563 RtlReleaseResource
                         2AB RtlAcquireResourceShared
                         2AA RtlAcquireResourceExclusive
                         481 RtlInitializeResource
                         45E RtlImpersonateSelf
                         23B NtSetEaFile
                         19F NtOpenFile
                          FD NtClose
                         116 NtCreateFile
                         243 NtSetInformationFile
                         1DC NtQueryInformationProcess
                         1FF NtQueryVolumeInformationFile
                         1D9 NtQueryInformationFile
                         257 NtSetSecurityObject
                         3D0 RtlFindAceByType
                         58F RtlSetControlSecurityDescriptor
                         425 RtlGetLastNtStatus
                         461 RtlInitAnsiString
                         3FC RtlFreeUnicodeString
                         2D2 RtlAllocateHeap
                         1F8 NtQuerySystemInformation
                         2CD RtlAdjustPrivilege
                         1CF NtQueryDirectoryFile
                         2DC RtlAppendUnicodeStringToString
                         6DA WinSqmEndSession
                         6E8 WinSqmSetString
                         6E4 WinSqmSetDWORD64
                         6E3 WinSqmSetDWORD
                         6E9 WinSqmStartSession
                         396 RtlDosPathNameToNtPathName_U
                         450 RtlGetVersion
                         46E RtlInitUnicodeString
                         3F5 RtlFreeHeap
                         4FE RtlNtStatusToDosErrorNoTeb
                         4FD RtlNtStatusToDosError
                         2F2 RtlCaptureContext
                         4E8 RtlLookupFunctionEntry
                         627 RtlVirtualUnwind

    dbghelp.dll
             1800E28B0 Import Address Table
             180125918 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          16 ImageNtHeader

    KERNEL32.dll
             1800E21B8 Import Address Table
             180125220 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         525 SetEvent
                         5E8 WaitForSingleObject
                         326 GetVersionExW
                         27C GetModuleFileNameW
                         648 lstrcmpiW
                         2EC GetSystemInfo
                         123 DeviceIoControl
                         32D GetVolumePathNameW
                         32B GetVolumeNameForVolumeMountPointW
                         254 GetFileSize
                         25D GetFirmwareEnvironmentVariableW
                         32F GetVolumePathNamesForVolumeNameW
                         232 GetDiskFreeSpaceW
                         350 HeapAlloc
                         2BD GetProcessHeap
                         188 FindFirstFileW
                         194 FindNextFileW
                         17D FindClose
                         354 HeapFree
                          BC CreateDirectoryW
                         52C SetFileAttributesW
                          DF CreatePipe
                          E7 CreateProcessW
                          CA CreateFileMappingW
                         3E4 MapViewOfFile
                         5C1 UnmapViewOfFile
                         219 GetCurrentDirectoryW
                           8 AddDllDirectory
                          F4 CreateThread
                         2B7 GetProcAddress
                         1B3 FreeLibrary
                         5E6 WaitForMultipleObjects
                         584 SetVolumeMountPointW
                         3D0 LocalAlloc
                         3D5 LocalFree
                         535 SetFileTime
                          A9 CopyFile2
                         256 GetFileTime
                         53A SetFirmwareEnvironmentVariableW
                         21F GetCurrentProcess
                         4BE RemoveDirectoryW
                         5BE UnhandledExceptionFilter
                         57D SetUnhandledExceptionFilter
                         451 QueryPerformanceCounter
                         220 GetCurrentProcessId
                         224 GetCurrentThreadId
                         310 GetTickCount
                         52F SetFileInformationByHandle
                         262 GetFullPathNameW
                         36A InitializeCriticalSectionAndSpinCount
                         3E0 LockFileEx
                         5C0 UnlockFileEx
                         26A GetLocalTime
                         411 OpenProcess
                          AC CopyFileExW
                         131 DuplicateHandle
                         2B2 GetPrivateProfileSectionW
                          C1 CreateEventW
                         245 GetExitCodeProcess
                         3C9 LoadLibraryExW
                         59C TerminateProcess
                          EE CreateSemaphoreW
                         328 GetVolumeInformationByHandleW
                         345 GlobalMemoryStatusEx
                         405 OpenEventW
                         5AE TlsAlloc
                         5AF TlsFree
                         5B0 TlsGetValue
                          9D CompareStringW
                         259 GetFinalPathNameByHandleW
                         2E9 GetSystemDirectoryW
                         5B1 TlsSetValue
                         5E7 WaitForMultipleObjectsEx
                         4CB ResetEvent
                         12C DosDateTimeToFileTime
                         3D2 LocalFileTimeToFileTime
                         251 GetFileInformationByHandleEx
                         359 HeapSize
                         467 RaiseException
                         183 FindFirstFileExW
                         353 HeapDestroy
                         5F0 WakeAllConditionVariable
                         58F SleepConditionVariableSRW
                         311 GetTickCount64
                         24E GetFileAttributesW
                         255 GetFileSizeEx
                         478 ReadFile
                          CD CreateFileW
                         531 SetFilePointer
                         623 WriteFile
                         118 DeleteFileW
                         518 SetCurrentDirectoryW
                         2F6 GetSystemWindowsDirectoryW
                          AF CopyFileW
                         269 GetLastError
                          88 CloseHandle
                         357 HeapReAlloc
                         568 SetThreadIdealProcessor
                         250 GetFileInformationByHandle
                         51F SetEndOfFile
                         532 SetFilePointerEx
                         266 GetHandleInformation
                         384 IsDebuggerPresent
                         109 DebugBreak
                           1 AcquireSRWLockShared
                          DB CreateMutexExW
                          F8 CreateThreadpoolTimer
                         4B8 ReleaseSRWLockShared
                         576 SetThreadpoolTimer
                         415 OpenSemaphoreW
                         5E9 WaitForSingleObjectEx
                           0 AcquireSRWLockExclusive
                          92 CloseThreadpoolTimer
                         41D OutputDebugStringW
                         4B7 ReleaseSRWLockExclusive
                         1AF FormatMessageW
                         4B5 ReleaseMutex
                         5EB WaitForThreadpoolTimerCallbacks
                         36B InitializeCriticalSectionEx
                         27F GetModuleHandleExW
                         4B9 ReleaseSemaphore
                          ED CreateSemaphoreExW
                         27B GetModuleFileNameA
                         113 DeleteCriticalSection
                         2A1 GetOverlappedResult
                         223 GetCurrentThread
                         369 InitializeCriticalSection
                         3C3 LeaveCriticalSection
                         137 EnterCriticalSection
                         3EE MoveFileExW
                         280 GetModuleHandleW
                         329 GetVolumeInformationW
                         1A7 FlushFileBuffers
                          D1 CreateHardLinkW
                         309 GetThreadPreferredUILanguages
                         60F WideCharToMultiByte
                         2FF GetTempPathW
                         3CA LoadLibraryW
                         331 GetWindowsDirectoryW
                         3F5 MultiByteToWideChar
                         540 SetLastError
                         242 GetEnvironmentVariableW
                         1A0 FindVolumeClose
                         199 FindNextVolumeW
                         238 GetDriveTypeW
                         18E FindFirstVolumeW
                         524 SetErrorMode
                         58D Sleep
                         2F2 GetSystemTimeAsFileTime
                         231 GetDiskFreeSpaceExW
                         2ED GetSystemPowerStatus
                         16A ExpandEnvironmentStringsW
                         42A PowerSetRequest
                         429 PowerCreateRequest
                         325 GetVersionExA
                         598 SystemTimeToFileTime

    ReAgent.dll
             1800E2728 Import Address Table
             180125790 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          19 WinReInstallOnTargetOS
                          25 WinReRestoreLogFiles
                          1B WinReIsWimBootEnabled
                           F WinReGetConfig
                           E WinReDeleteLogFiles
                          2B WinReSetRecoveryAction

    bcrypt.dll
             1800E2870 Import Address Table
             1801258D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          23 BCryptHashData
                          21 BCryptGetProperty
                          27 BCryptOpenAlgorithmProvider
                          1B BCryptFinishHash
                           D BCryptDestroyHash
                           2 BCryptCloseAlgorithmProvider
                           6 BCryptCreateHash

    FLTLIB.DLL
             1800E21A0 Import Address Table
             180125208 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          12 FilterLoad
                           0 FilterAttach

    USER32.dll
             1800E27C0 Import Address Table
             180125828 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         3B6 UnregisterClassA
                          3F CharUpperW
                         267 LoadStringW

    SHELL32.dll
             1800E27A0 Import Address Table
             180125808 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         1AD ShellExecuteExW

    ole32.dll
             1800E2E88 Import Address Table
             180125EF0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          62 CoInitializeSecurity
                          61 CoInitializeEx
                          2A CoCreateGuid
                          90 CoUninitialize
                          2B CoCreateInstance
                          8C CoTaskMemFree
                          87 CoSetProxyBlanket

    OLEAUT32.dll
             1800E26A0 Import Address Table
             180125708 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    23
                             Ordinal     8
                             Ordinal     9
                             Ordinal     4
                             Ordinal     6
                             Ordinal   149
                             Ordinal     2
                             Ordinal    10
                             Ordinal     7
                             Ordinal    24

    SETUPAPI.dll
             1800E2760 Import Address Table
             1801257C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         16E SetupDiGetDeviceInterfacePropertyW
                         13D SetupDiDestroyDeviceInfoList
                         193 SetupDiOpenDeviceInfoW
                         16C SetupDiGetDeviceInterfaceDetailW
                         141 SetupDiEnumDeviceInterfaces
                         154 SetupDiGetClassDevsW
                         170 SetupDiGetDevicePropertyW

    imagehlp.dll
             1800E28C0 Import Address Table
             180125928 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1F ImageUnload
                          1A ImageLoad

    RPCRT4.dll
             1800E26F8 Import Address Table
             180125760 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          44 I_RpcMapWin32Status
                         21C UuidCompare
                         21D UuidCreate
                         226 UuidToStringW
                         214 RpcStringFreeW

    ADVAPI32.dll
             1800E1F90 Import Address Table
             180124FF8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         1AF LookupPrivilegeValueW
                         121 EventRegister
                         122 EventSetInformation
                         129 EventWriteTransfer
                         285 RegLoadKeyW
                         281 RegGetValueW
                         2A6 RegSetKeyValueW
                         28C RegOpenKeyExW
                         25B RegCloseKey
                         2C1 RevertToSelf
                          63 CloseEncryptedFileRaw
                         358 WriteEncryptedFileRaw
                         212 OpenEncryptedFileRawW
                         27E RegFlushKey
                         273 RegDeleteValueW
                         138 GetAclInformation
                         15F GetSecurityDescriptorLength
                         15C GetSecurityDescriptorControl
                         124 EventWrite
                         2ED SetSecurityInfo
                         163 GetSecurityInfo
                         261 RegCopyTreeW
                         271 RegDeleteTreeW
                         2E3 SetNamedSecurityInfoW
                         162 GetSecurityDescriptorSacl
                         15D GetSecurityDescriptorDacl
                         15E GetSecurityDescriptorGroup
                         160 GetSecurityDescriptorOwner
                          81 ConvertStringSecurityDescriptorToSecurityDescriptorW
                         328 TraceMessage
                         195 InitiateSystemShutdownExW
                          1F AdjustTokenPrivileges
                         215 OpenProcessToken
                         2DC SetFileSecurityW
                         145 GetFileSecurityW
                          D2 CryptGenRandom
                          C2 CryptAcquireContextW
                         264 RegCreateKeyExW
                         27A RegEnumKeyExW
                         293 RegQueryInfoKeyW
                         299 RegQueryValueExW
                         120 EventProviderEnabled
                         2FF StopTraceW
                          67 CloseTrace
                         108 EnableTraceEx
                         2FD StartTraceW
                         2A9 RegSetValueExW
                         2AC RegUnLoadKeyW
                         123 EventUnregister

    SHLWAPI.dll
             1800E27B0 Import Address Table
             180125818 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         123 StrCmpIW

    DismApi.DLL
             1800E2140 Import Address Table
             1801251A8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          23 DismUnmountImage
                          1A DismMountImage
                          57 _DismSetProductKey
                          25 _DismAddDriverEx
                           6 DismCloseSession
                           8 DismDelete
                          33 _DismGetCurrentEdition
                          3E _DismGetOsInfo
                          1B DismOpenSession
                          19 DismInitialize
                          22 DismShutdown

    VSSAPI.DLL
             1800E2800 Import Address Table
             180125868 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          43 CreateVssBackupComponentsInternal
                          53 VssFreeSnapshotPropertiesInternal

    tbs.dll
             1800E2EC8 Import Address Table
             180125F30 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 Tbsi_Context_Create
                           C Tbsi_Physical_Presence_Command
                           7 Tbsi_GetDeviceInfo
                          10 Tbsip_Context_Close

    VirtDisk.dll
             1800E2818 Import Address Table
             180125880 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           E GetStorageDependencyInformation

    VERSION.dll
             1800E27E0 Import Address Table
             180125848 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 GetFileVersionInfoExW
                          10 VerQueryValueW
                           6 GetFileVersionInfoSizeExW

    Cabinet.dll
             1800E2120 Import Address Table
             180125188 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    23
                             Ordinal    20
                             Ordinal    22

    WDSCORE.dll
             1800E2828 Import Address Table
             180125890 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 ConstructPartialMsgVW
                           4 CurrentIP
                          28 WdsGenericSetupLogInit
                          55 WdsSetupLogMessageW
                           2 ConstructPartialMsgVA
                          31 WdsGetSetupLog
                          54 WdsSetupLogMessageA
                          52 WdsSetupLogDestroy

  Summary

        6000 .data
        6000 .pdata
       49000 .rdata
        1000 .reloc
        1000 .rsrc
       DF000 .text
