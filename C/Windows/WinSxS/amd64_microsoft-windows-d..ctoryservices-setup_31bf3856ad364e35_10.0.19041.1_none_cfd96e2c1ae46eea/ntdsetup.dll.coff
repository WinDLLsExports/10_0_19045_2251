Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\WinSxS\amd64_microsoft-windows-d..ctoryservices-setup_31bf3856ad364e35_10.0.19041.1_none_cfd96e2c1ae46eea\ntdsetup.dll

File Type: DLL

  Image has the following dependencies:

    msvcrt.dll
    ntdsbsrv.dll
    WLDAP32.dll
    api-ms-win-core-heap-l2-1-0.dll
    api-ms-win-core-errorhandling-l1-1-0.dll
    api-ms-win-security-base-l1-1-0.dll
    api-ms-win-core-registry-l1-1-0.dll
    DSPARSE.dll
    api-ms-win-core-processthreads-l1-1-0.dll
    api-ms-win-service-management-l1-1-0.dll
    api-ms-win-core-libraryloader-l1-2-0.dll
    api-ms-win-core-localization-l1-2-0.dll
    api-ms-win-security-sddl-l1-1-0.dll
    RPCRT4.dll
    api-ms-win-core-processenvironment-l1-1-0.dll
    api-ms-win-core-file-l1-1-0.dll
    api-ms-win-core-string-l1-1-0.dll
    api-ms-win-core-handle-l1-1-0.dll
    api-ms-win-service-management-l2-1-0.dll
    CRYPT32.dll
    api-ms-win-core-sysinfo-l1-1-0.dll
    api-ms-win-service-winsvc-l1-1-0.dll
    api-ms-win-core-synch-l1-2-0.dll
    api-ms-win-eventing-classicprovider-l1-1-0.dll
    WS2_32.dll
    logoncli.dll
    DNSAPI.dll
    api-ms-win-core-file-l2-1-2.dll
    netutils.dll
    api-ms-win-core-synch-l1-1-0.dll
    api-ms-win-core-rtlsupport-l1-1-0.dll
    api-ms-win-core-profile-l1-1-0.dll
    bcrypt.dll
    api-ms-win-core-heap-l1-1-0.dll
    certcli.dll
    LSASRV.dll
    ADVAPI32.dll
    cryptdll.dll
    KERNEL32.dll
    ntdll.dll
    NTDSA.dll
    NTDSAPI.dll
    SAMSRV.dll
    SHLWAPI.dll

  Section contains the following exports for NTDSETUP.dll

    00000000 characteristics
    87164629 time date stamp
        0.00 version
           1 ordinal base
          24 number of functions
          24 number of names

    ordinal hint RVA      name

          1    0 000184E0 AdamFetchDemotionInfo
          2    1 0000ED30 AdamGetCrossRefs
          3    2 00018910 FreeDemotionInfo
          4    3 00010160 NtdsAdamValidateInst
          5    4 000105F0 NtdsAdamValidateServiceAccount
          6    5 00010630 NtdsAdamVerifyBind
          7    6 000192D0 NtdsCheckMachineAccountFlags
          8    7 000192F0 NtdsDemote
          9    8 00012520 NtdsFreeDnsRRInfo
         10    9 000194A0 NtdsGetDefaultDnsName
         11    A 00004750 NtdsInstall
         12    B 000194B0 NtdsInstallCancel
         13    C 00019530 NtdsInstallReplicateFull
         14    D 00008980 NtdsInstallShutdown
         15    E 00019740 NtdsInstallUndo
         16    F 00019780 NtdsPrepareForDemotion
         17   10 000198A0 NtdsPrepareForDemotionUndo
         18   11 000198C0 NtdsPrepareForDsUpgrade
         19   12 00019B30 NtdsSetReplicaMachineAccount
         20   13 00002510 NtdspConfigRegistry
         21   14 0001B580 NtdspDNStoRFC1779Name
         22   15 0001BD60 NtdspFindSite
         23   16 00001190 NtdspValidateInstallParameters
         24   17 00008460 NtdspVerifyDsEnvironment

  Section contains the following imports:

    msvcrt.dll
             180028A78 Import Address Table
             18002F6D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         4D9 strtoul
                         47B isxdigit
                         422 bsearch
                         471 iswcntrl
                         466 isdigit
                         50B wcsncmp
                         33B _ultow_s
                         520 wprintf
                         1E1 _local_unwind
                         363 _vsnprintf
                         4DC swprintf_s
                          57 __C_specific_handler
                         491 memcmp
                         492 memcpy
                         494 memmove
                         496 memset
                         17D _initterm
                          AE _amsg_exit
                          55 _XcptFilter
                         470 iswascii
                         516 wcstok
                         4E9 tolower
                         409 _wtol
                         1F2 _ltow
                         405 _wtoi
                         28C _msize
                         385 _wcsdup
                         4D2 strrchr
                         4A4 qsort
                         394 _wcsnicmp
                         514 wcsstr
                         1D9 _itow
                         501 wcschr
                         51B wcstoul
                         505 wcscpy_s
                         1DA _itow_s
                         518 wcstol
                         486 malloc
                         420 atoi
                         44C free
                         38A _wcsicmp
                         369 _vsnwprintf
                         17C _i64tow_s
                         502 wcscmp

    ntdsbsrv.dll
             180028CF0 Import Address Table
             18002F948 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 NtdsbsrvDllInit
                           4 UnInstallBackupServices

    WLDAP32.dll
             1800284A0 Import Address Table
             18002F0F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    12
                             Ordinal   161
                             Ordinal   142
                             Ordinal    36
                             Ordinal   127
                             Ordinal   208
                             Ordinal   224
                             Ordinal   133
                             Ordinal   167
                             Ordinal    13
                             Ordinal   301
                             Ordinal   170
                             Ordinal    88
                             Ordinal    46
                             Ordinal    21
                             Ordinal   145
                             Ordinal   206
                             Ordinal   203
                             Ordinal    18
                             Ordinal    26
                             Ordinal    27
                             Ordinal    16
                             Ordinal   147
                             Ordinal    79
                             Ordinal   140
                             Ordinal   113
                             Ordinal   135
                             Ordinal    14
                             Ordinal    69
                             Ordinal    41
                             Ordinal    97
                             Ordinal    73
                             Ordinal   155
                             Ordinal   157

    api-ms-win-core-heap-l2-1-0.dll
             180028670 Import Address Table
             18002F2C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 LocalFree
                           5 LocalReAlloc
                           2 LocalAlloc

    api-ms-win-core-errorhandling-l1-1-0.dll
             1800285C8 Import Address Table
             18002F220 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F SetUnhandledExceptionFilter
                          11 UnhandledExceptionFilter
                           5 GetLastError

    api-ms-win-security-base-l1-1-0.dll
             1800288A8 Import Address Table
             18002F500 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          38 GetSecurityDescriptorDacl
                          62 SetSecurityDescriptorDacl
                          4F MakeAbsoluteSD
                          35 GetLengthSid
                          50 MakeSelfRelativeSD
                          48 InitializeSecurityDescriptor
                          28 DuplicateToken
                           8 AddAccessAllowedAceEx
                           D AddAce
                          63 SetSecurityDescriptorGroup
                          47 InitializeAcl
                          3A GetSecurityDescriptorLength
                          61 SetSecurityDescriptorControl
                          66 SetSecurityDescriptorSacl
                          3B GetSecurityDescriptorOwner
                          37 GetSecurityDescriptorControl
                          39 GetSecurityDescriptorGroup
                          2C EqualSid
                          64 SetSecurityDescriptorOwner
                          4D IsValidSid
                          30 GetAclInformation
                          2F GetAce
                          16 AllocateAndInitializeSid
                          2D FindFirstFreeAce
                          45 ImpersonateLoggedOnUser
                          3D GetSecurityDescriptorSacl
                          59 RevertToSelf
                          2E FreeSid

    api-ms-win-core-registry-l1-1-0.dll
             180028738 Import Address Table
             18002F390 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1D RegOpenKeyExA
                          24 RegQueryValueExA
                          25 RegQueryValueExW
                          2D RegSetValueExA
                           2 RegCreateKeyExA
                          1E RegOpenKeyExW
                           9 RegDeleteTreeW
                           0 RegCloseKey
                          2E RegSetValueExW
                          1B RegNotifyChangeKeyValue
                           B RegDeleteValueW

    DSPARSE.dll
             180028230 Import Address Table
             18002EE88 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F DsMakeSpnW

    api-ms-win-core-processthreads-l1-1-0.dll
             1800286F8 Import Address Table
             18002F350 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           8 ExitProcess
                          4E TerminateProcess
                           D GetCurrentProcessId
                          11 GetCurrentThreadId
                           C GetCurrentProcess

    api-ms-win-service-management-l1-1-0.dll
             1800289A0 Import Address Table
             18002F5F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseServiceHandle
                           4 OpenSCManagerW
                           2 CreateServiceW
                           3 DeleteService
                           5 OpenServiceW

    api-ms-win-core-libraryloader-l1-2-0.dll
             180028690 Import Address Table
             18002F2E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 DisableThreadLibraryCalls
                          15 GetProcAddress
                          11 GetModuleHandleA
                           C FreeLibrary
                          18 LoadLibraryExW
                          17 LoadLibraryExA

    api-ms-win-core-localization-l1-2-0.dll
             1800286C8 Import Address Table
             18002F320 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 FormatMessageW
                          24 GetUserDefaultLangID

    api-ms-win-security-sddl-l1-1-0.dll
             180028990 Import Address Table
             18002F5E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 ConvertSidToStringSidW

    RPCRT4.dll
             180028428 Import Address Table
             18002F080 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         226 UuidToStringW
                         214 RpcStringFreeW
                         21D UuidCreate

    api-ms-win-core-processenvironment-l1-1-0.dll
             1800286E0 Import Address Table
             18002F338 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 ExpandEnvironmentStringsA
                           B GetEnvironmentVariableW

    api-ms-win-core-file-l1-1-0.dll
             1800285E8 Import Address Table
             18002F240 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          14 FindFirstFileW
                          4D RemoveDirectoryW
                           3 CreateDirectoryW
                           C FindClose
                          2C GetFileAttributesW
                          1A FindNextFileW
                           9 DeleteFileW
                          52 SetFileAttributesW

    api-ms-win-core-string-l1-1-0.dll
             1800287B8 Import Address Table
             18002F410 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CompareStringEx
                           2 CompareStringW
                           6 MultiByteToWideChar

    api-ms-win-core-handle-l1-1-0.dll
             180028640 Import Address Table
             18002F298 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseHandle

    api-ms-win-service-management-l2-1-0.dll
             1800289D0 Import Address Table
             18002F628 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 ChangeServiceConfig2W

    CRYPT32.dll
             1800281F8 Import Address Table
             18002EE50 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          E1 CryptUnprotectData
                          C3 CryptProtectData
                          C4 CryptProtectMemory
                          E2 CryptUnprotectMemory

    api-ms-win-core-sysinfo-l1-1-0.dll
             180028840 Import Address Table
             18002F498 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          20 GetWindowsDirectoryW
                          13 GetSystemTime
                          16 GetSystemTimeAsFileTime
                           3 GetComputerNameExW
                           F GetSystemDirectoryW
                          1A GetTickCount

    api-ms-win-service-winsvc-l1-1-0.dll
             1800289E0 Import Address Table
             18002F638 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 ControlService
                           A QueryServiceStatus

    api-ms-win-core-synch-l1-2-0.dll
             180028830 Import Address Table
             18002F488 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          2D Sleep

    api-ms-win-eventing-classicprovider-l1-1-0.dll
             180028878 Import Address Table
             18002F4D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 GetTraceEnableFlags
                           1 GetTraceEnableLevel
                           2 GetTraceLoggerHandle
                           6 TraceMessageVa
                           3 RegisterTraceGuidsW

    WS2_32.dll
             1800285B8 Import Address Table
             18002F210 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    14

    logoncli.dll
             180028A68 Import Address Table
             18002F6C0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          12 DsGetDcNameW

    DNSAPI.dll
             180028220 Import Address Table
             18002EE78 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          B5 DnsValidateName_W

    api-ms-win-core-file-l2-1-2.dll
             180028630 Import Address Table
             18002F288 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 CopyFileW

    netutils.dll
             180028BE0 Import Address Table
             18002F838 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 NetApiBufferFree

    api-ms-win-core-synch-l1-1-0.dll
             1800287D8 Import Address Table
             18002F430 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          24 ReleaseSRWLockExclusive
                          1B InitializeSRWLock
                          11 EnterCriticalSection
                           0 AcquireSRWLockExclusive
                          1D LeaveCriticalSection
                          18 InitializeCriticalSection
                           1 AcquireSRWLockShared
                           3 CreateEventA
                           F DeleteCriticalSection
                          25 ReleaseSRWLockShared

    api-ms-win-core-rtlsupport-l1-1-0.dll
             180028798 Import Address Table
             18002F3F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          10 RtlVirtualUnwind
                           2 RtlCaptureContext
                           A RtlLookupFunctionEntry

    api-ms-win-core-profile-l1-1-0.dll
             180028728 Import Address Table
             18002F380 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 QueryPerformanceCounter

    bcrypt.dll
             1800289F8 Import Address Table
             18002F650 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          23 BCryptHashData
                          21 BCryptGetProperty
                           6 BCryptCreateHash
                           D BCryptDestroyHash
                          1B BCryptFinishHash
                          1D BCryptGenRandom
                          27 BCryptOpenAlgorithmProvider
                           2 BCryptCloseAlgorithmProvider

    api-ms-win-core-heap-l1-1-0.dll
             180028650 Import Address Table
             18002F2A8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           6 HeapFree
                           0 GetProcessHeap
                           2 HeapAlloc

    certcli.dll
             180028A40 Import Address Table
             18002F698 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          14 CACreateLocalAutoEnrollmentObject
                          1B CADeleteLocalAutoEnrollmentObject

    LSASRV.dll
             180028260 Import Address Table
             18002EEB8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          70 LsaIQueryInformationPolicyTrusted
                          7C LsaISafeMode
                          FD LsarClose
                          6D LsaIOpenPolicyTrusted
                         109 LsarSetInformationPolicy
                          35 LsaIFree_LSAPR_POLICY_INFORMATION

    ADVAPI32.dll
             180028138 Import Address Table
             18002ED90 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         2D8 SetEntriesInAclW
                         2AE RegisterEventSourceW
                         2C0 ReportEventW
                         1D2 LsaLookupSids
                         1CD LsaLookupNames
                         1C3 LsaFreeMemory
                          7D ConvertStringSDToSDDomainW
                         1E0 LsaQueryInformationPolicy
                         1D7 LsaOpenPolicy
                         1B5 LsaClose
                         1EB LsaSetInformationPolicy
                         262 RegCreateKeyA
                          61 ClearEventLogW
                         26F RegDeleteKeyW
                          64 CloseEventLog
                         2E3 SetNamedSecurityInfoW
                         157 GetNamedSecurityInfoW
                         1A5 LogonUserW
                         214 OpenEventLogW
                         267 RegCreateKeyW
                          ED DeregisterEventSource
                         1D5 LsaNtStatusToWinError
                         28F RegOpenKeyW

    cryptdll.dll
             180028A58 Import Address Table
             18002F6B0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 CDGenerateRandomBits

    KERNEL32.dll
             180028240 Import Address Table
             18002EE98 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         3F1 MoveFileW
                         1E7 GetComputerNameW
                         2B4 GetPrivateProfileStringW

    ntdll.dll
             180028BF0 Import Address Table
             18002F848 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         323 RtlConvertSidToUnicodeString
                         455 RtlIdentifierAuthoritySid
                         4CC RtlLargeIntegerToChar
                         3B9 RtlEqualSid
                         1B5 NtOpenThreadToken
                          FD NtClose
                         552 RtlReAllocateHeap
                         431 RtlGetNtProductType
                         24A NtSetInformationThread
                         1A2 NtOpenKey
                         154 NtEnumerateKey
                         144 NtDeleteKey
                         4D0 RtlLengthSecurityDescriptor
                         1E6 NtQueryKey
                          3D EtwEventUnregister
                         6CF WinSqmAddToStream
                         330 RtlCopySid
                         4CF RtlLengthRequiredSid
                         5CF RtlSubAuthorityCountSid
                         5D0 RtlSubAuthoritySid
                         484 RtlInitializeSid
                         621 RtlValidSid
                         4FD RtlNtStatusToDosError
                         3F5 RtlFreeHeap
                         2CF RtlAllocateAndInitializeSid
                         46E RtlInitUnicodeString
                         2D2 RtlAllocateHeap
                         4D1 RtlLengthSid
                          5B EvtIntReportEventAndSourceAsync
                          3B EtwEventRegister
                         6E0 WinSqmIsOptedIn

    NTDSA.dll
             180028298 Import Address Table
             18002EEF0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 AppendRDN
                          7F SampSetDsa
                          83 THCreate
                          5A GetConfigurationNamesList
                          4C DsUnloadDLL
                          81 THAlloc
                          82 THClearErrors
                          85 THFree
                          5C GetRDNInfoExternal
                          45 DsLoadDLL
                          4A DsUninitialize
                          23 DirReplicaAdd
                          50 DsaEnableUpdates
                          84 THDestroy
                          4F DsaDisableUpdates
                          17 DirErrorToWinError
                          2B DirReplicaSynchronize
                           A DSInstanceFromNameEx
                          51 DsaSetInstallCallback
                          25 DirReplicaDemote
                           B DSInstanceFromSetupEx
                          1B DirModifyEntry
                          26 DirReplicaGetDemoteTarget
                          5F InitCommarg
                          21 DirRead
                          13 DirAddEntry
                          2A DirReplicaSetCredentials
                           3 CountNameParts
                          86 THGetErrorString
                          2C DirSearch
                          74 QuoteRDNValue
                          40 DsInitialize
                          6F NameMatchedStringNameOnly
                          59 GetConfigurationName
                          6E NameMatched
                          43 DsIsDCReadOnly
                          8D TrimDSNameBy
                          87 THQuery

    NTDSAPI.dll
             1800283D0 Import Address Table
             18002F028 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           5 DsBindByInstanceW
                          63 DsReplicaDemotionW
                           A DsBindWithCredW
                           D DsBindWithSpnExW
                          6C DsReplicaSyncW
                          5D DsRemoveDsServerW
                          1E DsFinishDemotionW
                          74 DsUnBindW
                          39 DsInitDemotionW
                          5B DsRemoveDsDomainW

    SAMSRV.dll
             180028448 Import Address Table
             18002F0A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          44 SamIPromote
                          5F SamIUnLoadDownlevelDatabase
                          14 SamIDemoteUndo
                          13 SamIDemote
                          45 SamIPromoteUndo
                          4F SamIReplaceDownlevelDatabase
                         120 SampUsingDsData
                          39 SamILoadDownlevelDatabase

    SHLWAPI.dll
             180028490 Import Address Table
             18002F0E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          6B PathIsRootW

  Summary

        2000 .data
        2000 .pdata
        A000 .rdata
        1000 .reloc
        1000 .rsrc
       27000 .text
