Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\WinSxS\amd64_microsoft-windows-directory-services-sam_31bf3856ad364e35_10.0.19041.1_none_67df66e1405214df\offlinesam.dll

File Type: DLL

  Image has the following dependencies:

    msvcrt.dll
    ntdll.dll
    RPCRT4.dll
    bcrypt.dll
    offlinelsa.dll
    CRYPTBASE.dll
    api-ms-win-core-heap-obsolete-l1-1-0.dll
    api-ms-win-eventing-classicprovider-l1-1-0.dll
    api-ms-win-security-base-l1-1-0.dll
    api-ms-win-core-file-l1-1-0.dll
    api-ms-win-core-string-l1-1-0.dll
    api-ms-win-core-synch-l1-1-0.dll
    api-ms-win-core-processthreads-l1-1-0.dll
    api-ms-win-core-processthreads-l1-1-1.dll
    api-ms-win-core-errorhandling-l1-1-0.dll
    api-ms-win-core-handle-l1-1-0.dll
    api-ms-win-core-kernel32-legacy-l1-1-0.dll
    api-ms-win-security-sddl-l1-1-0.dll
    api-ms-win-security-lsalookup-l2-1-0.dll
    api-ms-win-core-libraryloader-l1-1-0.dll
    api-ms-win-core-synch-l1-2-0.dll
    api-ms-win-core-profile-l1-1-0.dll
    api-ms-win-core-sysinfo-l1-1-0.dll
    api-ms-win-core-memory-l1-1-0.dll
    api-ms-win-security-cryptoapi-l1-1-0.dll

  Section contains the following exports for offlinesam.dll

    00000000 characteristics
    BB3635FB time date stamp
        0.00 version
           1 ordinal base
          25 number of functions
          25 number of names

    ordinal hint RVA      name

          1    0 00010770 SamOfflineAddMemberToAlias
          2    1 000112D0 SamOfflineCloseHandle
          3    2 0000F9D0 SamOfflineConnect
          4    3 0000FBC0 SamOfflineConnectExternal
          5    4 0000FAE0 SamOfflineConnectForInstaller
          6    5 000102D0 SamOfflineCreateAliasInDomain
          7    6 00010E10 SamOfflineCreateUserInDomain
          8    7 00010610 SamOfflineDeleteAlias
          9    8 00011130 SamOfflineDeleteUser
         10    9 00010A60 SamOfflineEnumerateAliasesInDomain
         11    A 0000FD20 SamOfflineEnumerateDomainsInSamServer
         12    B 00010BA0 SamOfflineEnumerateUsersInDomain2
         13    C 00011440 SamOfflineFreeMemory
         14    D 00010960 SamOfflineGetMembersInAlias
         15    E 0000FE50 SamOfflineLookupDomainInSamServer
         16    F 00010080 SamOfflineLookupNamesInDomain
         17   10 000101B0 SamOfflineOpenAlias
         18   11 0000FF50 SamOfflineOpenDomain
         19   12 00010CF0 SamOfflineOpenUser
         20   13 00010420 SamOfflineQueryInformationAlias
         21   14 00010F50 SamOfflineQueryInformationUser
         22   15 00010880 SamOfflineRemoveMemberFromAlias
         23   16 00011220 SamOfflineRidToSid
         24   17 00010510 SamOfflineSetInformationAlias
         25   18 00011040 SamOfflineSetInformationUser

  Section contains the following imports:

    msvcrt.dll
             18001F828 Import Address Table
             180023940 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          55 _XcptFilter
                         38A _wcsicmp
                         44C free
                         486 malloc
                         17D _initterm
                         29E _purecall
                          57 __C_specific_handler
                         494 memmove
                         492 memcpy
                         491 memcmp
                          AE _amsg_exit
                         369 _vsnwprintf
                         496 memset

    ntdll.dll
             18001F898 Import Address Table
             1800239B0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         1A2 NtOpenKey
                         46E RtlInitUnicodeString
                          FD NtClose
                         330 RtlCopySid
                         11B NtCreateKey
                         45A RtlImageNtHeader
                         60E RtlUpcaseUnicodeChar
                          23 DbgPrintEx
                         552 RtlReAllocateHeap
                         2D2 RtlAllocateHeap
                         54D RtlRaiseStatus
                         3EF RtlFormatCurrentUserKeyPath
                         627 RtlVirtualUnwind
                         4E8 RtlLookupFunctionEntry
                         2F2 RtlCaptureContext
                         3DD RtlFindMessage
                         2DD RtlAppendUnicodeToString
                         48E RtlIntegerToUnicodeString
                         612 RtlUpcaseUnicodeStringToOemString
                         4CF RtlLengthRequiredSid
                         333 RtlCopyUnicodeString
                         455 RtlIdentifierAuthoritySid
                         2DC RtlAppendUnicodeStringToString
                          CD NtAdjustPrivilegesToken
                         1FD NtQueryValueKey
                         263 NtSetValueKey
                         422 RtlGetGroupSecurityDescriptor
                         147 NtDeleteValueKey
                         257 NtSetSecurityObject
                         434 RtlGetOwnerSecurityDescriptor
                         43B RtlGetSaclSecurityDescriptor
                         66C RtlpNtEnumerateSubKey
                         144 NtDeleteKey
                         1E6 NtQueryKey
                         1B5 NtOpenThreadToken
                         1DF NtQueryInformationToken
                         24A NtSetInformationThread
                         1F8 NtQuerySystemInformation
                         150 NtDuplicateToken
                         1AC NtOpenProcessToken
                         312 RtlCompareUnicodeString
                         413 RtlGetDaclSecurityDescriptor
                         349 RtlCreateSecurityDescriptor
                         59B RtlSetGroupSecurityDescriptor
                         336 RtlCreateAcl
                         2BC RtlAddAuditAccessAce
                         2A6 RtlAbsoluteToSelfRelativeSD
                         2B1 RtlAddAccessAllowedAce
                         2CF RtlAllocateAndInitializeSid
                         401 RtlGetAce
                         594 RtlSetDaclSecurityDescriptor
                         4EB RtlMapGenericMask
                         484 RtlInitializeSid
                         5A3 RtlSetOwnerSecurityDescriptor
                         5AB RtlSetSaclSecurityDescriptor
                         4D1 RtlLengthSid
                         5CF RtlSubAuthorityCountSid
                         3FC RtlFreeUnicodeString
                         323 RtlConvertSidToUnicodeString
                         5D0 RtlSubAuthoritySid
                         621 RtlValidSid
                         1FA NtQuerySystemTime
                         3B9 RtlEqualSid
                         3F5 RtlFreeHeap
                         27D NtUnloadKey2
                         161 NtFlushKey
                         399 RtlDosPathNameToRelativeNtPathName_U_WithStatus
                         184 NtLoadKey
                         480 RtlInitializeRXact

    RPCRT4.dll
             18001F588 Import Address Table
             1800236A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         226 UuidToStringW
                         214 RpcStringFreeW
                         21D UuidCreate

    bcrypt.dll
             18001F7C0 Import Address Table
             1800238D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1B BCryptFinishHash
                           D BCryptDestroyHash
                           8 BCryptDecrypt
                          23 BCryptHashData
                           6 BCryptCreateHash
                          27 BCryptOpenAlgorithmProvider
                          35 BCryptSetProperty
                           2 BCryptCloseAlgorithmProvider
                          1F BCryptGenerateSymmetricKey
                          21 BCryptGetProperty
                           E BCryptDestroyKey
                          12 BCryptEncrypt

    offlinelsa.dll
             18001FAC8 Import Address Table
             180023BE0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           B LsaOfflineOpenPolicy
                           D LsaOfflineOpenPolicyForInstaller
                           2 LsaOfflineClose
                           E LsaOfflineQueryInformationPolicy
                           8 LsaOfflineFreeMemory
                          12 LsaOfflineSyskeyRequest
                           C LsaOfflineOpenPolicyExternal

    CRYPTBASE.dll
             18001F568 Import Address Table
             180023680 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           8 SystemFunction036
                           0 SystemFunction001
                           2 SystemFunction003

    api-ms-win-core-heap-obsolete-l1-1-0.dll
             18001F5E8 Import Address Table
             180023700 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           8 LocalAlloc
                           A LocalFree

    api-ms-win-eventing-classicprovider-l1-1-0.dll
             18001F708 Import Address Table
             180023820 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 GetTraceLoggerHandle
                           3 RegisterTraceGuidsW
                           0 GetTraceEnableFlags
                           7 UnregisterTraceGuids
                           5 TraceMessage
                           1 GetTraceEnableLevel

    api-ms-win-security-base-l1-1-0.dll
             18001F740 Import Address Table
             180023858 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          46 IsValidSid
                          2D GetLengthSid
                          3A GetTokenInformation
                          23 DuplicateTokenEx

    api-ms-win-core-file-l1-1-0.dll
             18001F5C8 Import Address Table
             1800236E0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          22 GetFileAttributesW

    api-ms-win-core-string-l1-1-0.dll
             18001F6A8 Import Address Table
             1800237C0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CompareStringEx

    api-ms-win-core-synch-l1-1-0.dll
             18001F6B8 Import Address Table
             1800237D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 AcquireSRWLockExclusive
                          12 InitializeSRWLock
                          1A ReleaseSRWLockExclusive

    api-ms-win-core-processthreads-l1-1-0.dll
             18001F650 Import Address Table
             180023768 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           D GetCurrentThreadId
                          26 SetThreadStackGuarantee
                           A GetCurrentProcess
                          2A TerminateProcess
                          1A OpenProcessToken
                           B GetCurrentProcessId

    api-ms-win-core-processthreads-l1-1-1.dll
             18001F688 Import Address Table
             1800237A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           A OpenProcess

    api-ms-win-core-errorhandling-l1-1-0.dll
             18001F5A8 Import Address Table
             1800236C0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           6 UnhandledExceptionFilter
                           1 GetLastError
                           5 SetUnhandledExceptionFilter

    api-ms-win-core-handle-l1-1-0.dll
             18001F5D8 Import Address Table
             1800236F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseHandle

    api-ms-win-core-kernel32-legacy-l1-1-0.dll
             18001F600 Import Address Table
             180023718 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          34 WTSGetActiveConsoleSessionId

    api-ms-win-security-sddl-l1-1-0.dll
             18001F7B0 Import Address Table
             1800238C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 ConvertStringSidToSidW

    api-ms-win-security-lsalookup-l2-1-0.dll
             18001F7A0 Import Address Table
             1800238B8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 LookupPrivilegeValueW

    api-ms-win-core-libraryloader-l1-1-0.dll
             18001F610 Import Address Table
             180023728 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 DisableThreadLibraryCalls
                           4 FreeLibrary
                           F LoadLibraryExW

    api-ms-win-core-synch-l1-2-0.dll
             18001F6D8 Import Address Table
             1800237F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 Sleep

    api-ms-win-core-profile-l1-1-0.dll
             18001F698 Import Address Table
             1800237B0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 QueryPerformanceCounter

    api-ms-win-core-sysinfo-l1-1-0.dll
             18001F6E8 Import Address Table
             180023800 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 GetSystemInfo
                           A GetSystemTimeAsFileTime
                           D GetTickCount

    api-ms-win-core-memory-l1-1-0.dll
             18001F630 Import Address Table
             180023748 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 VirtualAlloc
                           B VirtualProtect
                           D VirtualQuery

    api-ms-win-security-cryptoapi-l1-1-0.dll
             18001F768 Import Address Table
             180023880 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CryptAcquireContextA
                           3 CryptCreateHash
                          14 CryptGetHashParam
                           6 CryptDestroyHash
                          18 CryptHashData
                          1B CryptReleaseContext

  Summary

        1000 .data
        2000 .pdata
        6000 .rdata
        1000 .reloc
       18000 .rsrc
       1E000 .text
